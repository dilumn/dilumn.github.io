---
author: dilumnavanjana
layout: post
title: "Dialog login vulnerability explained"
date: 2020-06-27 23:00
comments: true
category : security
tags:
- security
---

Finally Dialog fixed their login vulnerability. So it is time to explain in deep what was it.


`Note: Vulnerability is already fixed. So you won't be able to try it by yourself. This blog post is for education purposes.`


First of all go to Dialog.lk

<img height="360" width="480" style='border:1px solid #000000' src="{{ site.url }}/images/dialog-2.png"/>

By Clicking Log in - mobile connect button with any Dialog mobile number or clicking Log in button without any User Name, Password

<img height="400" width="600" style='border:1px solid #000000' src="{{ site.url }}/images/dialog-3.png"/>


You can go to Dialog Mobile phone authentication page.

<img height="400" width="300" style='border:1px solid #000000' src="{{ site.url }}/images/dialog-4.png"/>

This is where all fun begins. You can enter any Dialog number you want & Dialog will send a notification to accept. Because it will take few seconds for a user to accept notification, frontend check notification status with backend every few seconds using an API endpoint.

This is the API response looks like for not accepted notification.

<img height="300" width="900" style='border:1px solid #000000' src="{{ site.url }}/images/dialog-5.png"/>

If you look carefully there is a id return from this API, that is where Dialog got it wrong. So what is this id? If you try again with the same mobile number for two factor authentication, you will see id is not same. So it is not an id related to the mobile number. If you look little bit closer you will see 2nd attempt request id is slightly higher than the first attempt request id. For example 2nd attempt request id can be something like `8030728`. So it is clear that API response id is incremental & every time when a user try to log in to Dialog a new id generated by backend & frontend use that id to check notification status.

Then the next question is, if I know my request id & it is incremental, can I check other users two factor authentication status if I can replicate this API call? The answer is yes. You can do it as a Curl command or using Postman or what ever way you like.

So you can continue checking other users two factor authentication status.

<img height="400" width="600" style='border:1px solid #000000' src="{{ site.url }}/images/dialog-6.png"/>

Still not that bad because I can see `status: "3"` which is not approved notification with some other data. But once the user you are checking accept the notification, things get ugly. Like this ugly.

<img height="400" width="600" style='border:1px solid #000000' src="{{ site.url }}/images/dialog-7.png"/>

Dialog is returning a SSO url to frontend, so frontend can redirect user to this SSO url & user will be automatically logged in. Using this url now you can log into that user's account.

<img height="400" width="600" style='border:1px solid #000000' src="{{ site.url }}/images/dialog-8.png"/>

And then there are so many things you can do. Check his personal information, his payment history, bill history, activate deactivate packages & so on.

Most hilarious part was that SSO url could be reused multiple times. Invalidate SSO url once it is used should be very basic level of security.

So within 9 hours after I publish the previous blog post, Dialog fixed the issue. Now they return a GUID instead of incremental id as the request id. Hope they fixed SSO url not expiring after 1st use issue also.

Here is a screen recording of the above steps I explained.

<iframe width="16" height="9" src="https://www.youtube.com/embed/jmk678Rgct0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<br>
Cheers,<br>
DilumN
